<html>
<head>
    <meta charset="utf-8"/>
<meta name="description" content=""/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Nmap 学习手册 | MokYan</title>
<link rel="shortcut icon" href="https://M0kY4n.github.io/Websec/favicon.ico?v=1625391093726">
<link href="https://cdn.bootcss.com/font-awesome/5.11.2/css/all.css" rel="stylesheet">
<link rel="stylesheet" href="https://M0kY4n.github.io/Websec/styles/main.css">
<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css"
      integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">

<script src="https://cdn.bootcss.com/highlight.js/9.15.10/highlight.min.js"></script>
<script src="https://cdn.bootcss.com/highlight.js/9.15.10/languages/dockerfile.min.js"></script>
<script src="https://cdn.bootcss.com/highlight.js/9.15.10/languages/dart.min.js"></script>
<script src="https://cdn.bootcss.com/highlight.js/9.15.10/languages/go.min.js"></script>
<script src="https://cdn.bootcss.com/moment.js/2.23.0/moment.min.js"></script>
<script src="https://code.jquery.com/jquery-3.4.1.slim.min.js"
        integrity="sha384-J6qa4849blE2+poT4WnyKhv5vZF5SrPo0iEjwBvKU7imGFAV0wwj1yYfoRSJoZ+n"
        crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js"
        integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo"
        crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js"
        integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6"
        crossorigin="anonymous"></script>

<!-- DEMO JS -->
<script src="media/scripts/index.js"></script>



    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/katex.min.css">
</head>
<body>
<div class="main gt-bg-theme-color-first">
    <nav class="navbar navbar-expand-lg">
    <div class="navbar-brand">
        <img class="user-avatar" src="/images/avatar.png" alt="头像">
        <div class="site-name gt-c-content-color-first">
            MokYan
        </div>
    </div>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
        <i class="fas fa-bars gt-c-content-color-first" style="font-size: 18px"></i>
    </button>
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
        <div class="navbar-nav mr-auto" style="text-align: center">
            
                <div class="nav-item">
                    
                        <a href="/" class="menu gt-a-link">
                            首页
                        </a>
                    
                </div>
            
                <div class="nav-item">
                    
                        <a href="/archives" class="menu gt-a-link">
                            归档
                        </a>
                    
                </div>
            
                <div class="nav-item">
                    
                        <a href="/tags" class="menu gt-a-link">
                            标签
                        </a>
                    
                </div>
            
                <div class="nav-item">
                    
                        <a href="/post/about" class="menu gt-a-link">
                            关于
                        </a>
                    
                </div>
            
        </div>
    </div>
</nav>
    <div class="post-container">
        <div class="post-detail gt-bg-theme-color-second">
            <article class="gt-post-content">
                <h2 class="post-title">
                    Nmap 学习手册
                </h2>
                <div class="post-info">
                    <time class="post-time gt-c-content-color-first">
                        · 2021-03-12 ·
                    </time>
                    
                        <a href="https://M0kY4n.github.io/Websec/tag/zcJSAKR9O/" class="post-tags">
                            # Nmap
                        </a>
                    
                        <a href="https://M0kY4n.github.io/Websec/tag/ov9f1l9vPE/" class="post-tags">
                            # Web安全
                        </a>
                    
                </div>
                <div class="post-content">
                    <p>nmap学习手册</p>
<h1 id="nmap-描述">nmap 描述</h1>
<p>​		Nmap (“Network Mapper(网络映射器)”) 是一款开放源代码的 网络探测和安全审核的工具。它的设计目标是快速地扫描大型网络，当然用它扫描单个 主机也没有问题。Nmap以新颖的方式使用原始IP报文来发现网络上有哪些主机，那些 主机提供什么服务(应用程序名和版本)，那些服务运行在什么操作系统(包括版本信息)， 它们使用什么类型的报文过滤器/防火墙，以及一堆其它功能。虽然Nmap通常用于安全审核， 许多系统管理员和网络管理员也用它来做一些日常的工作，比如查看整个网络的信息， 管理服务升级计划，以及监视主机和服务的运行。 —— 来自<a href="https://nmap.org/man/zh/index.html">nmap官网</a></p>
<br>
<br>
<h1 id="nmap语法">nmap语法</h1>
<pre><code class="language-shell">nmap [扫描类型&amp;选项] (目标)
</code></pre>
<br>
<br>
<h1 id="nmap目标">nmap目标</h1>
<p>nmap的目标可以传递<strong>主机名 , IP地址 , 网段</strong>等</p>
<br>
<br>
<h1 id="nmap扫描类型选项">nmap扫描类型&amp;选项</h1>
<h2 id="快速扫描">快速扫描</h2>
<p>nmap 192.168.50.148</p>
<p>nmap会发送一个ping包 , 来检测目标主机上以开放的端口(范围暂不清楚) , 不推荐此方法检测,因为结果比较模糊</p>
<figure data-type="image" tabindex="1"><img src="https://raw.githubusercontent.com/MokYan/Figurebed/master/nmap/nmap-scan.jpg" alt="nmap 扫描" loading="lazy"></figure>
<br>
<h2 id="主机发现">主机发现</h2>
<h3 id="-sl-列表发现">-sL : 列表发现</h3>
<p>​	仅对发现主机列出来,不进行任何扫描</p>
<figure data-type="image" tabindex="2"><img src="https://raw.githubusercontent.com/MokYan/Figurebed/master/nmap/nmap-sL.jpg" alt="nmap -sL扫描" loading="lazy"></figure>
<h3 id="-sp-ping扫描">-sP : Ping扫描</h3>
<p>​	只确定是否在线,不进行更深一步扫描</p>
<figure data-type="image" tabindex="3"><img src="https://raw.githubusercontent.com/MokYan/Figurebed/master/nmap/nmap-sP.jpg" alt="nmap -sP扫描" loading="lazy"></figure>
<br>
<h2 id="扫描技巧">扫描技巧</h2>
<h3 id="-ss-半开放扫描">-sS : 半开放扫描</h3>
<p>​	使用频率比较高的扫描类型 , <a href="https://baike.baidu.com/item/SYN/8880122?fr=aladdin">SYN</a>扫描 , 又称为半开放扫描 , 它不需要建立一个完整<a href="https://baike.baidu.com/item/TCP/33012?fr=aladdin">TCP</a>连接(建立一次TCP需要进行三次握手 , 而第一次握手则是发送SYN报文),因此 TCP SYN Scan(sS) 被称为半开放扫描</p>
<ul>
<li>
<p>优点 : nmap 发送 SYN包到目标是不会产生任何会话 , 目标主机几乎不会把连接记入系统日志(并非一定 ! ! ! , 能有效阻止目标判断为扫描攻击) , 扫描速度快 , 效率高 , 在工作中使用频率较高</p>
</li>
<li>
<p>缺点 : 执行命令需要系统最高权限,即 root 或者 Administrator 权限</p>
<figure data-type="image" tabindex="4"><img src="https://raw.githubusercontent.com/MokYan/Figurebed/master/nmap/nmap-sS.jpg" alt="nmap -sS扫描" loading="lazy"></figure>
</li>
</ul>
<h3 id="-st-tcp扫描">-sT : TCP扫描</h3>
<p>​	TCP connect() Scan (sT) , 相对于TCP SYN Scan , TCP connect() Scan 是默认的扫描模式,使用TCP connect()扫描需要调用系统的connect()</p>
<ul>
<li>
<p>优点 : 执行命令无需系统最高权限 , 普通用户亦可执行命令</p>
</li>
<li>
<p>缺点 : 由于扫描会产生会话 , 所以目标主机会记录大量的连接请求记入系统日志 , 并且若有防护程序则会识别出扫描攻击 , 因为要进行三次握手 , 所以速度较慢 , 效率较低</p>
<figure data-type="image" tabindex="5"><img src="https://raw.githubusercontent.com/MokYan/Figurebed/master/nmap/nmap-sT.jpg" alt="nmap -sT扫描" loading="lazy"></figure>
</li>
</ul>
<h3 id="-su-udp扫描">-sU : UDP扫描</h3>
<p>​	<a href="https://baike.baidu.com/item/UDP/571511">UDP</a> Scan(sU) 相对于 SYN扫描和TCP扫描 , UDP扫描无需进行三次握手和发送SYN包 , 因为 UDP Scan是针对UDP端口扫描的,只需发送UDP数据包到目标 , 然后等待响应即可</p>
<p>​	如果返回是ICMP的错误信息 , 这说明端口是关闭的 , 若返回是正确的回应 , 则说明端口是开放的 , UDP扫描速度会很慢 , 比TCP扫描慢😓</p>
<p>​	<img src="https://raw.githubusercontent.com/MokYan/Figurebed/master/nmap/nmap-sU.jpg" alt="nmap -sU扫描" loading="lazy"></p>
<h3 id="-sf-fin扫描">-sF : FIN扫描</h3>
<p>​	FIN扫描也是TCP的一种扫描 , 发送一个FIN标志的数据包 , 有时候目标主机可能存在IDS和IPS系统,会阻止掉SYN数据包 , 因此FIN标志的数据包一般不会阻止 , 而且FIN标志的数据包也是无需进行TCP的三次握手 , 因此FIN扫描也是大概率不会被目标把连接记入系统日志 , 扫描的信息相对较少</p>
<p>​	<img src="https://raw.githubusercontent.com/MokYan/Figurebed/master/nmap/nmap-sF.jpg" alt="nmap -sF扫描" loading="lazy"></p>
<h3 id="-sf-sx-sn-原理类似">-sF -sX -sN : 原理类似</h3>
<p>​	原理大致相同 -sF 是 发送FIN数据包扫描 -sX 是 圣诞树(XmasTree)扫描 -sN是 空(NULL)扫描</p>
<p>​	有的防火墙可能会阻止 -sS扫描 , 使用这些扫描类型可以绕过阻止进行扫描 , 他们也是没有进行TCP三次握手 , 目标主机大概率不会被目标把连接记入系统日志,且扫描速度比 -sT 块</p>
<ul>
<li>优点 : 能躲过一些无状态防火墙和报文过滤路由器，比SYN还要隐秘</li>
<li>缺点 : 现代的IDS产品可以发现，并非所有的系统严格遵循<a href="https://harttle.land/2014/09/27/tcp.html">RFC 793</a></li>
</ul>
<br>
<h2 id="服务版本识别">服务版本识别</h2>
<h3 id="-sv-version版本扫描检测">-sV : Version版本扫描检测</h3>
<p>​	Version 版本检测是用来扫描目标主机上的端口服务版本 , 不过此扫描选项不能用来扫描目标开放端口 , 因此使用此选项之前 , 请使用TCPSYN进行端口开放扫描</p>
<ul>
<li>
<p>--version-intensity &quot;Level&quot; : 设置版本扫描强度 , Level范围为0~9 默认为7</p>
</li>
<li>
<p>--version-light : 轻量级扫描 , 即 --version-intensity 2</p>
</li>
<li>
<p>--version-all : 重度扫描 : 即 --version-intensity 9</p>
</li>
<li>
<p>version-trace : 显示详细的扫描过程 ()</p>
<figure data-type="image" tabindex="6"><img src="https://raw.githubusercontent.com/MokYan/Figurebed/master/nmap/nmap-sV.jpg" alt="nmap -sV扫描" loading="lazy"></figure>
</li>
</ul>
<br>
<h2 id="操作系统识别">操作系统识别</h2>
<h3 id="-o-os操作系统扫描检测">-O : OS操作系统扫描检测</h3>
<p>OS操作系统扫描检测 , 可以远程轿车操作系统信息 , 这些信息是十分有用的 , 通过获取的信息可以知道已知的漏洞</p>
<ul>
<li>--osscan-guess : 猜测匹配操作系统</li>
<li>--osscan-limit : 针对指定的目标进行系统检测</li>
</ul>
<figure data-type="image" tabindex="7"><img src="https://raw.githubusercontent.com/MokYan/Figurebed/master/nmap/nmap-O.jpg" alt="nmap -O扫描" loading="lazy"></figure>
<br>
<h2 id="脚本扫描">脚本扫描</h2>
<pre><code class="language-shell">nmap --script 具体的脚本 目标
</code></pre>
<p>nmap官方脚本文档 : https://nmap.org/nsedoc/</p>
<p>左侧列出了脚本的分类，点击分类 可以看到每一个分类下有很多具体的脚本供我们使用。14大分类具体对应为</p>
<ul>
<li><a href="https://nmap.org/nsedoc/categories/auth.html">auth</a> : 负责处理鉴权证书的脚本</li>
<li><a href="https://nmap.org/nsedoc/categories/broadcast.html">broadcast</a> : 在局域网内探查更多服务开启状况，如dhcp/dns/sqlserver等服务</li>
<li><a href="https://nmap.org/nsedoc/categories/brute.html">brute</a> : 提供暴力破解方式，针对常见的应用如http/snmp等</li>
<li><a href="https://nmap.org/nsedoc/categories/default.html">default</a> : 使用-sC或-A选项扫描时候默认的脚本，提供基本脚本扫描能力</li>
<li><a href="https://nmap.org/nsedoc/categories/discovery.html">discovery</a> : 对网络进行更多的信息，如SMB枚举、SNMP查询等</li>
<li><a href="https://nmap.org/nsedoc/categories/dos.html">dos</a> : 用于进行拒绝服务攻击</li>
<li><a href="https://nmap.org/nsedoc/categories/exploit.html">exploit</a> : 利用已知的漏洞入侵系统</li>
<li><a href="https://nmap.org/nsedoc/categories/external.html">external</a> : 利用第三方的数据库或资源，例如进行whois解析</li>
<li><a href="https://nmap.org/nsedoc/categories/fuzzer.html">fuzzer</a> : 模糊测试的脚本，发送异常的包到目标机，探测出潜在漏洞</li>
<li><a href="https://nmap.org/nsedoc/categories/intrusive.html">intrusive</a> : 入侵性的脚本，此类脚本可能引发对方的IDS/IPS的记录或屏蔽</li>
<li><a href="https://nmap.org/nsedoc/categories/malware.html">malware</a> : 探测目标机是否感染了病毒、开启了后门等信息</li>
<li><a href="https://nmap.org/nsedoc/categories/safe.html">safe</a> : 此类与intrusive相反，属于安全性脚本</li>
<li><a href="https://nmap.org/nsedoc/categories/version.html">version</a> : 负责增强服务与版本扫描（Version Detection）功能的脚本</li>
<li><a href="https://nmap.org/nsedoc/categories/vuln.html">vuln</a> : 负责检查目标机是否有常见的漏洞（Vulnerability），如是否有MS08_067</li>
</ul>
<h3 id="对ssh进行暴力破解">对SSH进行暴力破解</h3>
<p>账号密码不是弱口令,所以结果是跑不出来🤣</p>
<figure data-type="image" tabindex="8"><img src="https://raw.githubusercontent.com/MokYan/Figurebed/master/nmap/nmap-sC.jpg" alt="nmap -sC-SSH" loading="lazy"></figure>
<br>
<h2 id="时间模板">时间模板</h2>
<h3 id="-t0-5-设置时间模板">-T&lt;0-5&gt; 设置时间模板</h3>
<pre><code class="language-shell">nmap -sS -T&lt;0-5&gt; 192.168.1.148
</code></pre>
<p>优化时间控制选项的功能很强大也很有效，但有些用户会被迷惑。此外， 往往选择合适参数的时间超过了所需优化的扫描时间。因此，Nmap提供了一些简单的 方法，使用6个时间模板，使用时采用-T选项及数字(0 - 5) 或名称。模板名称有<code>paranoid (0)、sneaky (1)、polite (2)、normal(3)、 aggressive (4)和insane (5)</code></p>
<ul>
<li>paranoid、sneaky模式用于IDS躲避</li>
<li>Polite模式降低了扫描 速度以使用更少的带宽和目标主机资源。</li>
<li>Normal为默认模式，因此-T3 实际上是未做任何优化。</li>
<li>Aggressive模式假设用户具有合适及可靠的网络从而加速 扫描.</li>
<li>nsane模式假设用户具有特别快的网络或者愿意为获得速度而牺牲准确性。</li>
</ul>
<figure data-type="image" tabindex="9"><img src="https://raw.githubusercontent.com/MokYan/Figurebed/master/nmap/nmap-T.jpg" alt="nmap -T" loading="lazy"></figure>
<h2 id="其他选项">其他选项</h2>
<h3 id="-a-综合扫描">-A 综合扫描</h3>
<p>此选项包含了 1-10000端口ping扫描 , 操作系统扫描 , 脚本扫描 , 路由追踪 , 服务探测</p>
<pre><code class="language-shell">nmap -A 192.168.50.148
</code></pre>
<figure data-type="image" tabindex="10"><img src="https://raw.githubusercontent.com/MokYan/Figurebed/master/nmap/nmap-A.jpg" alt="nmap -A" loading="lazy"></figure>

                </div>
            </article>
        </div>

        
            <div class="next-post">
                <div class="next gt-c-content-color-first">下一篇</div>
                <a href="https://M0kY4n.github.io/Websec/post/testxsstv/" class="post-title gt-a-link">
                    XSS弹窗练习 : http://test.xss.tv
                </a>
            </div>
        

        
            
                <link rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css">
<script src="https://unpkg.com/gitalk/dist/gitalk.min.js"></script>

<div id="gitalk-container"></div>

<script>

  var gitalk = new Gitalk({
    clientID: '33314f7248b5c9af3dd7',
    clientSecret: 'a00f05259046ad817d64c59027a0388812fe40b7',
    repo: 'MokYan.github.io',
    owner: 'MokYan',
    admin: ['MokYan'],
    id: location.pathname,      // Ensure uniqueness and length less than 50
    distractionFreeMode: false  // Facebook-like distraction free mode
  })

  gitalk.render('gitalk-container')

</script>

            

            
        

        <div class="site-footer gt-c-content-color-first">
    <div class="slogan gt-c-content-color-first">The more you know, the more you don't know</div>
    <div class="social-container">
        
            
        
            
        
            
                <a href="https://weibo.com/2125865220/profile?topnav=1&amp;wvr=6" target="_blank">
                    <i class="fab fa-weibo gt-c-content-color-first"></i>
                </a>
            
        
            
                <a href="https://www.zhihu.com/people/damo-18-66" target="_blank">
                    <i class="fab fa-zhihu gt-c-content-color-first"></i>
                </a>
            
        
            
        
            
        
    </div>
    Powered by <a href="https://github.com/getgridea/gridea" target="_blank">Gridea</a> | <a href="https://M0kY4n.github.io/Websec/atom.xml" target="_blank">RSS</a>
</div>

<script>
    hljs.initHighlightingOnLoad()
</script>


    </div>
</div>
</body>
</html>
